founder.georef %in% c("POLBIS-KA-HUL-D-0001", "POLBIS-KA-HUL-D-0007", "POLBIS-KA-HUL-A-0003", "POLBIS-KA-HUL-A-0004", "POLBIS-KA-HUL-A-0005", "POLBIS-KA-HUL-A-0009") ~ "kahili.upper",
founder.georef %in% c("POLBIS-KA-KAP-A-0001", "POLBIS-KA-KAP-A-0003", "POLBIS-KA-KAP-A-0006") ~ "makaleha",
founder.georef %in% c("POLBIS-KA-XXX-X-XXXX") ~ "unknown.founder",
TRUE ~ "other"
))
data.frame(polbis.data$founder.georef, polbis.data$genetic.group)
table(polbis.data$founder.georef)
table(polbis.data$genetic.group)
#Creating new column for degree of weed control at each site
polbis.data <- polbis.data %>%
mutate(weed.control = case_when(
site %in% c("Laauhihaihai", "LowerHaupu", "Makaleha", "PuuKolo", "Nounou") ~ "none",
site %in% c("BlueHole", "HaupuSummit", "Kanaele", "McBryde") ~ "sporadic",
site %in% c("LowerLimahuli", "UpperLimahuli") ~ "consistent"))
data.frame(polbis.data$site, polbis.data$weed.control)
#Creating new summary columns of vegetation plot categories. Species can be moved as needed, or extracted if independently important (i.e. uluhe, invasive grass, etc)
polbis.data <- polbis.data %>%
mutate(native.herbaceous = (Alyxia.stellata+Bidens.spp+Bidens.spp+Cyanea.fissa+Cyanea.spp+Dianella.sandwicensis+
Diplazium.sandwichianum+Diplazium.sandwichianum+Doryopteris.sp+Dryopteris.spp+
Dubautia.spp+Dubautia.spp+Elaphoglossum.spp+Gahnia.beecheyi+Machaerina.angustifolia+Machaerina.mariscoides+
Microlepia.strigosa.+nativeherb+Odontosoria.chinensis+Palhinhaea.cernua+Peperomia.spp+Sadleria.cyatheoides+
Rubus.argutus+Sadleria.spp+Tectaria.gaudichaudii+Viola.wailenalenae),
native.woody = (Antidesma.platyphyllum+Cibotium.glaucum+Cyrtandra.spp+Diospyros.sandwicensis+Freycinetia.arborea+
Hydrangea.arguta+Ilex.anomala+Kadua.spp+Leptecophylla.tameiameiae+Metrosideros.polymorpha+
Myrsine.lessertiana+nativewood+Perrottetia.sandwicensis+Pipturus.albidus+Pipturus.ruber+Psychotria.spp+Psychotria.mariniana+Polyscias.oahuensis+
Vaccinium.calycinum+Syzygium.sandwicense+Scaevola.gaudichaudiana+Scaevola.procera),
uluhe = (Dicranopteris.linearis),
naturalized.herbaceous = (Ageratum.conyzoides+Blechnum.appendiculatum+Christella.dentata+Cyperus.spp+Elephantopus.mollis+invherb+
Ipomea.spp+Nephrolepis.spp+Paederia.foetida+Passiflora.spp+Phaius.tankervilleae+
Phlebotium.aureum+Pluchea.spp+Selaginella.spp+Stachytarpheta.cayennensis),
naturalized.woody = (Clidemia.hirta+Cordyline.fruticosa+invwood+Leucaena.leucocephala+Melastoma.septemnervium+
Psidium.cattleyanum+Schinus.terebinthifolius),
naturalized.poaceae = (Andropogon.spp+Megathyrsus.maximus+Melinis.minutiflora+Oplismenus.hirtellus+Invasive.Grass))
#If need to subset to remove sites or founders with fewer founders
polbis.data.subset <- subset(polbis.data, !(site %in% c("Kanaele", "Nounou")))
subset.polbis.data <- polbis.data[, c("site", "X21.height", "genetic.group", "canopy.cover", "understory.height",
"slope.angle", "weed.control","native.herbaceous","native.woody",
"uluhe","naturalized.herbaceous", "naturalized.woody", "naturalized.poaceae")]
View(saturated.model)
colSums(is.na(subset.polbis.data))
saturated.model <- lm(log.height~site+genetic.group+canopy.cover+understory.height+
slope.angle+weed.control+native.herbaceous+native.woody+uluhe+
naturalized.herbaceous+naturalized.woody+naturalized.poaceae,
data=subset.polbis.data)
dredge(saturated.model)
summary(saturated.model)
dredge(saturated.model)
colSums(is.na(subset.polbis.data))
saturated.model <- lm(log.height~site+genetic.group+canopy.cover+understory.height+
slope.angle+weed.control+native.herbaceous+native.woody+uluhe+
naturalized.herbaceous+naturalized.woody+naturalized.poaceae,
data=subset.polbis.data)
summary(saturated.model)
dredge(saturated.model)
saturated.model <- lm(log.height~site+genetic.group+canopy.cover+understory.height+
slope.angle+weed.control+native.herbaceous+native.woody+uluhe+
naturalized.herbaceous+naturalized.woody+naturalized.poaceae,
data=subset.polbis.data, na.action = "na.fail")
dredge(saturated.model)
source("~/Desktop/ohe.mauka/Polyscias Kauai 2022/polbis.analysis/rscripts/model.building.R", echo=TRUE)
#PCA of environmental variables
polbis.environmental.variables <- subset(polbis.data, select=c(site,canopy.cover, percent.native, slope.angle,understory.depth,
naturalized.herbaceous, native.woody, naturalized.woody, naturalized.poaceae, uluhe)) #subsetting for the env.measured
#PCA of environmental variables
polbis.environmental.variables <- subset(polbis.data, select=c(site,canopy.cover, percent.native, slope.angle,understory.height,
naturalized.herbaceous, native.woody, naturalized.woody, naturalized.poaceae, uluhe)) #subsetting for the env.measured
polbis.environmental.variables["percent.native"][is.na(polbis.environmental.variables["percent.native"])] <- 0 #removing NAs from data, replacing 0 for NA for percent.native, because some sites have no canopy
polbis.environmental.variables <- na.omit(polbis.environmental.variables) #removing another few odd NAs in there
str(polbis.environmental.variables)
pca.polbis.dataset <- subset(polbis.environmental.variables, select=c(canopy.cover, percent.native, slope.angle,understory.depth,
naturalized.herbaceous, native.woody, naturalized.woody, naturalized.poaceae, uluhe))#removing site as a categorical variable
pca.polbis.dataset <- subset(polbis.environmental.variables, select=c(canopy.cover, percent.native, slope.angle,understory.height,
naturalized.herbaceous, native.woody, naturalized.woody, naturalized.poaceae, uluhe))#removing site as a categorical variable
pca.polbis.dataset.scaled <- as.data.frame(scale(pca.polbis.dataset))#scaling it
rda.polbis.sites <- rda(pca.polbis.dataset.scaled)
biplot(rda.polbis.sites)
points(rda.polbis.sites, disp="sites", pch=20, col="green", select=polbis.environmental.variables$site=="Nounou", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="2", select=polbis.environmental.variables$site=="LowerLimahuli", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="4", select=polbis.environmental.variables$site=="Makaleha", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="5", select=polbis.environmental.variables$site=="McBryde", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="6", select=polbis.environmental.variables$site=="UpperLimahuli", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="dark green", select=polbis.environmental.variables$site=="HaupuSummit", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="8", select=polbis.environmental.variables$site=="Kanaele", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col= "gold", select=polbis.environmental.variables$site=="Laauhihaihai", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="10", select=polbis.environmental.variables$site=="PuuKolo", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="11", select=polbis.environmental.variables$site=="LowerHaupu", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="12", select=polbis.environmental.variables$site=="BlueHole", cex=1.3)
text(rda.polbis.sites, display="species", col="black", cex=1, pos=3, offset=.5)
legend("topright", col = c("green",2,4,5,6,"dark green",8,"gold",10,11,12), pch = 16,
legend = c("Nounou", "LowerLimahuli","Makaleha","McBryde","UpperLimahuli","HaupuSummit","Kanaele",
"Laauhihaihai","PuuKolo","LowerHaupu","BlueHole"))
biplot(rda.polbis.sites)
points(rda.polbis.sites, disp="sites", pch=20, col="green", select=polbis.environmental.variables$site=="Nounou", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="2", select=polbis.environmental.variables$site=="LowerLimahuli", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="4", select=polbis.environmental.variables$site=="Makaleha", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="5", select=polbis.environmental.variables$site=="McBryde", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="6", select=polbis.environmental.variables$site=="UpperLimahuli", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="dark green", select=polbis.environmental.variables$site=="HaupuSummit", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="8", select=polbis.environmental.variables$site=="Kanaele", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col= "gold", select=polbis.environmental.variables$site=="Laauhihaihai", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="10", select=polbis.environmental.variables$site=="PuuKolo", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="11", select=polbis.environmental.variables$site=="LowerHaupu", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="12", select=polbis.environmental.variables$site=="BlueHole", cex=1.3)
text(rda.polbis.sites, display="species", col="black", cex=1, pos=3, offset=.5)
legend("topright", col = c("green",2,4,5,6,"dark green",8,"gold",10,11,12), pch = 16,
legend = c("Nounou", "LowerLimahuli","Makaleha","McBryde","UpperLimahuli","HaupuSummit","Kanaele",
"Laauhihaihai","PuuKolo","LowerHaupu","BlueHole"))
#Barplots of vigor across sites
ggplot(polbis.data, aes(x = site, fill=X21.vigor)) + geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent) +  scale_fill_brewer(palette = "Pastel1")
#Creating new summary columns of vegetation plot categories. Species can be moved as needed, or extracted if independently important (i.e. uluhe, invasive grass, etc)
polbis.data <- polbis.data %>%
mutate(native.herbaceous = (Alyxia.stellata+Bidens.spp+Bidens.spp+Cyanea.fissa+Cyanea.spp+Dianella.sandwicensis+
Diplazium.sandwichianum+Diplazium.sandwichianum+Doryopteris.sp+Dryopteris.spp+
Dubautia.spp+Dubautia.spp+Elaphoglossum.spp+Gahnia.beecheyi+Machaerina.angustifolia+Machaerina.mariscoides+
Microlepia.strigosa.+nativeherb+Odontosoria.chinensis+Palhinhaea.cernua+Peperomia.spp+Sadleria.cyatheoides+
Rubus.argutus+Sadleria.spp+Tectaria.gaudichaudii+Viola.wailenalenae),
native.woody = (Antidesma.platyphyllum+Cibotium.glaucum+Cyrtandra.spp+Diospyros.sandwicensis+Freycinetia.arborea+
Hydrangea.arguta+Ilex.anomala+Kadua.spp+Leptecophylla.tameiameiae+Metrosideros.polymorpha+
Myrsine.lessertiana+nativewood+Perrottetia.sandwicensis+Pipturus.albidus+Pipturus.ruber+Psychotria.spp+Psychotria.mariniana+Polyscias.oahuensis+
Vaccinium.calycinum+Syzygium.sandwicense+Scaevola.gaudichaudiana+Scaevola.procera),
uluhe = (Dicranopteris.linearis),
naturalized.herbaceous = (Ageratum.conyzoides+Blechnum.appendiculatum+Christella.dentata+Cyperus.spp+Elephantopus.mollis+invherb+
Ipomea.spp+Nephrolepis.spp+Paederia.foetida+Passiflora.spp+Phaius.tankervilleae+
Phlebotium.aureum+Pluchea.spp+Selaginella.spp+Stachytarpheta.cayennensis),
naturalized.woody = (Clidemia.hirta+Cordyline.fruticosa+invwood+Leucaena.leucocephala+Melastoma.septemnervium+
Psidium.cattleyanum+Schinus.terebinthifolius),
naturalized.poaceae = (Andropogon.spp+Megathyrsus.maximus+Melinis.minutiflora+Oplismenus.hirtellus+Invasive.Grass))
#Barplots of vigor across sites
ggplot(polbis.data, aes(x = site, fill=X21.vigor)) + geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent) +  scale_fill_brewer(palette = "Pastel1")+
theme(axis.text.x = element_text(angle = 90))
#important! add your repo path here so r knows where are the repo files!
repo_path1="D:/projects/2021_ntbg/polbis_analysis/"
repo_path2="~/Desktop/ohe.mauka/Polyscias Kauai 2022/polbis.analysis/" #JULIA, place your repo directory here
REPO_dirs=c(repo_path1, repo_path2)
repo_dir=REPO_dirs[min(which(dir.exists(REPO_dirs)))]
setwd(repo_dir)
polbis.data <- read.csv("data/PolBis.Data.2022.csv")
polbis.data <- as.data.frame(polbis.data)
polbis.data <- subset(polbis.data[1:430,]) #remove blank columns
polbis.data$tempRowID=c(1:nrow(polbis.data))
#View(polbis.data)
#dput(names(polbis.data))
sp_name_cols=c("species1", "species2", "species3", "species4", "species5")
sp_pct_cols=c("species1.percent", "species2.percent", "species3.percent",
"species4.percent", "species5.percent")
tmp_spp_data_df=polbis.data[,c("tempRowID", sp_name_cols, sp_pct_cols)]
sp_name_df=polbis.data[,c("tempRowID", sp_name_cols)]
sp_pct_df=polbis.data[,c("tempRowID", sp_pct_cols)]
library(reshape2)
sp_name_df_long=melt(sp_name_df, id.vars = "tempRowID")
sp_pct_df_long=melt(sp_pct_df, id.vars = "tempRowID")
sp_df_long=sp_name_df_long[,-2]
sp_df_long=cbind(sp_df_long, sp_pct_df_long[,"value"])
names(sp_df_long)=c("tempRowID", "species", "cover")
sp_df=dcast(data = sp_df_long, formula = tempRowID ~ species, fun.aggregate = sum)
polbis.data=merge(polbis.data, sp_df, by="tempRowID") #now, re add reorganized data back to df
polbis.data=polbis.data[,-1] #remove tempRowID col
#View(polbis.data)
write.csv(polbis.data, "data/processed_PolBis.Data.Living.22.csv", row.names = F)
#Bring in polbis data from github folder
polbis.data <- read.csv("data/processed_PolBis.Data.Living.22.csv")
polbis.data <- as.data.frame(polbis.data)
#polbis.data <- subset(polbis.data[1:430,])
str(polbis.data)
#making continuous variables numeric (height, diameter, canopy cover, slope aspect)
polbis.data$X19.height <- as.numeric(as.character(polbis.data$X19.height))
polbis.data$X19.diameter <- as.numeric(as.character(polbis.data$X19.diameter))
polbis.data$X21.diameter  <- as.numeric(as.character(polbis.data$X21.diameter ))
polbis.data$X21.height  <- as.numeric(as.character(polbis.data$X21.height ))
polbis.data$canopy.cover <- as.numeric(as.character(polbis.data$canopy.cover))
polbis.data$angles <- as.numeric(as.character(polbis.data$slope.angle))
polbis.data$percent.native <- as.numeric(as.character(polbis.data$percent.native))
str(polbis.data)
ggplot(polbis.data, aes(x = site, fill=X21.vigor)) + geom_bar(position = "fill", stat="identity") +
scale_y_continuous(labels = scales::percent) +  scale_fill_brewer(palette = "Pastel1")+
theme(axis.text.x = element_text(angle = 90))
ggplot(polbis.data, aes(x = site, fill=X21.vigor)) + geom_bar(position = "fill", stat="identity") +
scale_y_continuous(labels = scales::percent) +  scale_fill_brewer(palette = "Pastel1")+
theme(axis.text.x = element_text(angle = 90))
ggplot(polbis.data, aes(x = site, fill=X21.vigor)) + geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent) +  scale_fill_brewer(palette = "Pastel1")+
theme(axis.text.x = element_text(angle = 90))
#ANOVA vigor varying by site
vigor.sites.anova <- aov(X21.vigor.numeric~site, data=polbis.data2)
#ANOVA to test differences in growth means across sites
#SITES ANOVA - Need to remove the sites which don't have enough replicates
#removing the sites that have less than 5 replicates
polbis.data2 <- subset(polbis.data, !(site %in% c("Kanaele", "Nounou")))
#ANOVA vigor varying by site
vigor.sites.anova <- aov(X21.vigor.numeric~site, data=polbis.data2)
summary(vigor.sites.anova)
TukeyHSD(vigor.sites.anova)
TukeyHSD(vigor.sites.anova)
sites.tukey7 <- TukeyHSD(vigor.sites.anova)
anova.letters7 <- multcompLetters4(vigor.sites.anova, sites.tukey7)
print(anova.letters7)
Tk7 <- group_by(polbis.data2, site) %>%
summarise(mean=mean(X21.vigor.numeric), quant = quantile(X21.vigor.numeric, probs = 0.75, na.rm=TRUE)) %>%
arrange(desc(mean))
anova.letters7 <- as.data.frame.list(anova.letters7$site)
Tk7$anova.letters7 <- anova.letters7$Letters
print(Tk7)
ggplot(data=polbis.data2, aes(x=site, y=X21.vigor.numeric)) + geom_boxplot() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x="Reintroduction Site", y="Plant vigor ") +
geom_text(data = Tk7, aes(x = site, y = quant, label = anova.letters7), vjust=1.5)+
ggtitle("Variation in PolBis '21 vigor across sites")
#ANOVA, vigor varying by founder genetic group
vigor.founder.anova <- aov(X21.vigor.numeric~genetic.group, data=polbis.data2)
#Creating new column for degree of weed control at each site
polbis.data <- polbis.data %>%
mutate(weed.control = case_when(
site %in% c("Laauhihaihai", "LowerHaupu", "Makaleha", "PuuKolo", "Nounou") ~ "none",
site %in% c("BlueHole", "HaupuSummit", "Kanaele", "McBryde") ~ "sporadic",
site %in% c("LowerLimahuli", "UpperLimahuli") ~ "consistent"))
data.frame(polbis.data$site, polbis.data$weed.control)
#Creating new column for aggregation categories of similar genetic founders
polbis.data <- polbis.data %>%
mutate(genetic.group = case_when(
founder.georef %in% c("POLBIS-KA-HUL-C-0001", "POLBIS-KA-HUL-C-0003", "POLBIS-KA-HUL-E-0001", "POLBIS-KA-HUL-E-0003") ~ "haupu",
founder.georef %in% c("POLBIS-KA-HUL-B-0001", "POLBIS-KA-HUL-B-0004", "POLBIS-KA-HUL-B-0005", "POLBIS-KA-HUL-B-0006", "POLBIS-KA-HUL-B-0007", "POLBIS-KA-HUL-B-0008") ~ "kahili.lower",
founder.georef %in% c("POLBIS-KA-HUL-D-0001", "POLBIS-KA-HUL-D-0007", "POLBIS-KA-HUL-A-0003", "POLBIS-KA-HUL-A-0004", "POLBIS-KA-HUL-A-0005", "POLBIS-KA-HUL-A-0009") ~ "kahili.upper",
founder.georef %in% c("POLBIS-KA-KAP-A-0001", "POLBIS-KA-KAP-A-0003", "POLBIS-KA-KAP-A-0006") ~ "makaleha",
founder.georef %in% c("POLBIS-KA-XXX-X-XXXX") ~ "unknown.founder",
TRUE ~ "other"
))
print(polbis.data[c(founder.georef,genetic.group)])
table(polbis.data$site, polbis.data$genetic.group)
#ANOVA, vigor varying by founder genetic group
vigor.founder.anova <- aov(X21.vigor.numeric~genetic.group, data=polbis.data2)
#ANOVA to test differences in growth means across sites
#SITES ANOVA - Need to remove the sites which don't have enough replicates
#removing the sites that have less than 5 replicates
polbis.data2 <- subset(polbis.data, !(site %in% c("Kanaele", "Nounou")))
str(polbis.data2)
#ANOVA, vigor varying by founder genetic group
vigor.founder.anova <- aov(X21.vigor.numeric~genetic.group, data=polbis.data2)
summary(vigor.sites.anova)
summary(vigor.founder.anova)
TukeyHSD(vigor.sites.anova)
TukeyHSD(vigor.founder.anova)
ggplot(data=polbis.data2, aes(x=genetic.group, y=X21.vigor.numeric)) + geom_boxplot() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x="Reintroduction Site", y="Plant vigor ") +
ggtitle("Variation in PolBis '21 vigor across genetic.group")
ggplot(polbis.data, aes(x = site, fill=X21.vigor)) + geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent) +  scale_fill_brewer(palette = "Pastel1") +
theme(axis.text.x = element_text(angle = 90))
ggplot(polbis.data, aes(x =reorder(site, -X21.vigor), fill=X21.vigor)) + geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent) +  scale_fill_brewer(palette = "Pastel1") +
theme(axis.text.x = element_text(angle = 90))
ggplot(polbis.data, aes(x =fct_infreq(X21.vigor)), fill=X21.vigor) + geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent) +  scale_fill_brewer(palette = "Pastel1") +
theme(axis.text.x = element_text(angle = 90))
ggplot(polbis.data, aes(x =site, fill=X21.vigor)) + geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent) +  scale_fill_brewer(palette = "Pastel1") +
theme(axis.text.x = element_text(angle = 90))
polbis.data$site <- factor(polbis.data$site, levels=c("PuuKolo", "HaupuSummit", "LowerLimahuli",
"McBryde","Nounou","Makaleha","LowerHaupu",
"Laauhihaihai","BlueHole", "UpperLimahuli","Kanaele"))
ggplot(polbis.data, aes(x =site, fill=X21.vigor)) + geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent) +  scale_fill_brewer(palette = "Pastel1") +
theme(axis.text.x = element_text(angle = 90))
polbis.data$site <- factor(polbis.data$site, levels=c("PuuKolo", "McBryde","HaupuSummit", "LowerLimahuli",
"Nounou","Makaleha","LowerHaupu",
"Laauhihaihai","BlueHole", "UpperLimahuli","Kanaele"))
ggplot(polbis.data, aes(x =site, fill=X21.vigor)) + geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent) +  scale_fill_brewer(palette = "Pastel1") +
theme(axis.text.x = element_text(angle = 90))
polbis.data$site <- factor(polbis.data$site, levels=c("PuuKolo", "McBryde", "LowerLimahuli",
"Nounou", "HaupuSummmit", "Makaleha","LowerHaupu",
"Laauhihaihai","BlueHole", "UpperLimahuli","Kanaele"))
ggplot(polbis.data, aes(x =site, fill=X21.vigor)) + geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent) +  scale_fill_brewer(palette = "Pastel1") +
theme(axis.text.x = element_text(angle = 90))
polbis.data$site <- factor(polbis.data$site, levels=c("PuuKolo", "McBryde", "LowerLimahuli",
"Nounou", "HaupuSummmit","Makaleha","LowerHaupu",
"Laauhihaihai","BlueHole", "UpperLimahuli","Kanaele"))
ggplot(polbis.data, aes(x =site, fill=X21.vigor)) + geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent) +  scale_fill_brewer(palette = "Pastel1") +
theme(axis.text.x = element_text(angle = 90))
which(is.na(your_dataset), arr.ind = TRUE)
str(polbis.data)
str(polbis.data$ste)
view(polbis.data$site)
polbis.data <- read.csv("data/PolBis.Data.2022.csv")
polbis.data <- as.data.frame(polbis.data)
polbis.data <- subset(polbis.data[1:430,]) #remove blank columns
polbis.data$tempRowID=c(1:nrow(polbis.data))
#View(polbis.data)
#dput(names(polbis.data))
sp_name_cols=c("species1", "species2", "species3", "species4", "species5")
sp_pct_cols=c("species1.percent", "species2.percent", "species3.percent",
"species4.percent", "species5.percent")
tmp_spp_data_df=polbis.data[,c("tempRowID", sp_name_cols, sp_pct_cols)]
sp_name_df=polbis.data[,c("tempRowID", sp_name_cols)]
sp_pct_df=polbis.data[,c("tempRowID", sp_pct_cols)]
library(reshape2)
sp_name_df_long=melt(sp_name_df, id.vars = "tempRowID")
sp_pct_df_long=melt(sp_pct_df, id.vars = "tempRowID")
sp_df_long=sp_name_df_long[,-2]
sp_df_long=cbind(sp_df_long, sp_pct_df_long[,"value"])
names(sp_df_long)=c("tempRowID", "species", "cover")
sp_df=dcast(data = sp_df_long, formula = tempRowID ~ species, fun.aggregate = sum)
polbis.data=merge(polbis.data, sp_df, by="tempRowID") #now, re add reorganized data back to df
polbis.data=polbis.data[,-1] #remove tempRowID col
#View(polbis.data)
write.csv(polbis.data, "data/processed_PolBis.Data.Living.22.csv", row.names = F)
#Bring in polbis data from github folder
polbis.data <- read.csv("data/processed_PolBis.Data.Living.22.csv")
polbis.data <- as.data.frame(polbis.data)
#polbis.data <- subset(polbis.data[1:430,])
str(polbis.data)
#making continuous variables numeric (height, diameter, canopy cover, slope aspect)
polbis.data$X19.height <- as.numeric(as.character(polbis.data$X19.height))
polbis.data$X19.diameter <- as.numeric(as.character(polbis.data$X19.diameter))
polbis.data$X21.diameter  <- as.numeric(as.character(polbis.data$X21.diameter ))
polbis.data$X21.height  <- as.numeric(as.character(polbis.data$X21.height ))
polbis.data$canopy.cover <- as.numeric(as.character(polbis.data$canopy.cover))
polbis.data$angles <- as.numeric(as.character(polbis.data$slope.angle))
polbis.data$percent.native <- as.numeric(as.character(polbis.data$percent.native))
str(polbis.data)
#Creating new column for aggregation categories of similar genetic founders
polbis.data <- polbis.data %>%
mutate(genetic.group = case_when(
founder.georef %in% c("POLBIS-KA-HUL-C-0001", "POLBIS-KA-HUL-C-0003", "POLBIS-KA-HUL-E-0001", "POLBIS-KA-HUL-E-0003") ~ "haupu",
founder.georef %in% c("POLBIS-KA-HUL-B-0001", "POLBIS-KA-HUL-B-0004", "POLBIS-KA-HUL-B-0005", "POLBIS-KA-HUL-B-0006", "POLBIS-KA-HUL-B-0007", "POLBIS-KA-HUL-B-0008") ~ "kahili.lower",
founder.georef %in% c("POLBIS-KA-HUL-D-0001", "POLBIS-KA-HUL-D-0007", "POLBIS-KA-HUL-A-0003", "POLBIS-KA-HUL-A-0004", "POLBIS-KA-HUL-A-0005", "POLBIS-KA-HUL-A-0009") ~ "kahili.upper",
founder.georef %in% c("POLBIS-KA-KAP-A-0001", "POLBIS-KA-KAP-A-0003", "POLBIS-KA-KAP-A-0006") ~ "makaleha",
founder.georef %in% c("POLBIS-KA-XXX-X-XXXX") ~ "unknown.founder",
TRUE ~ "other"
))
print(polbis.data[c(founder.georef,genetic.group)])
table(polbis.data$site, polbis.data$genetic.group)
data.frame(polbis.data$founder.georef, polbis.data$genetic.group)
table(polbis.data$founder.georef)
table(polbis.data$genetic.group)
#Creating new column for degree of weed control at each site
polbis.data <- polbis.data %>%
mutate(weed.control = case_when(
site %in% c("Laauhihaihai", "LowerHaupu", "Makaleha", "PuuKolo", "Nounou") ~ "none",
site %in% c("BlueHole", "HaupuSummit", "Kanaele", "McBryde") ~ "sporadic",
site %in% c("LowerLimahuli", "UpperLimahuli") ~ "consistent"))
data.frame(polbis.data$site, polbis.data$weed.control)
#Plot of founders represented in living reintroductions across sites
ggplot(data=polbis.data, aes(x=site, fill=founder.georef)) + geom_bar() + theme(axis.text.x = element_text(angle = 90))+
ggtitle("PolBis founders represented across sites") +
labs(x="Reintroduction Site", y="# Living Reintroduced Individuals ('21)")
#Plot of genetic groupings represented in living reintroductions across sites
ggplot(data=polbis.data, aes(x=site, fill=genetic.group)) + geom_bar() + theme(axis.text.x = element_text(angle = 90)) +
ggtitle("PolBis genetic groups represented across sites") +
labs(x="Reintroduction Site", y="# Living Reintroduced Individuals ('21)")
#Barplots of vigor across sites
polbis.data$site <- reorder(polbis.data$site, df$values, FUN = function(x) -sum(x))
polbis.data$site <- factor(polbis.data$site, levels=c("PuuKolo", "McBryde", "LowerLimahuli",
"Nounou", "HaupuSummmit","Makaleha","LowerHaupu",
"Laauhihaihai","BlueHole", "UpperLimahuli","Kanaele"))
ggplot(polbis.data, aes(x =site, fill=X21.vigor)) + geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent) +  scale_fill_brewer(palette = "Pastel1") +
theme(axis.text.x = element_text(angle = 90))
print(polbis.data$site)
polbis.data <- read.csv("data/PolBis.Data.2022.csv")
polbis.data <- as.data.frame(polbis.data)
polbis.data <- subset(polbis.data[1:430,]) #remove blank columns
polbis.data$tempRowID=c(1:nrow(polbis.data))
#View(polbis.data)
#dput(names(polbis.data))
sp_name_cols=c("species1", "species2", "species3", "species4", "species5")
sp_pct_cols=c("species1.percent", "species2.percent", "species3.percent",
"species4.percent", "species5.percent")
tmp_spp_data_df=polbis.data[,c("tempRowID", sp_name_cols, sp_pct_cols)]
sp_name_df=polbis.data[,c("tempRowID", sp_name_cols)]
sp_pct_df=polbis.data[,c("tempRowID", sp_pct_cols)]
library(reshape2)
sp_name_df_long=melt(sp_name_df, id.vars = "tempRowID")
sp_pct_df_long=melt(sp_pct_df, id.vars = "tempRowID")
sp_df_long=sp_name_df_long[,-2]
sp_df_long=cbind(sp_df_long, sp_pct_df_long[,"value"])
names(sp_df_long)=c("tempRowID", "species", "cover")
sp_df=dcast(data = sp_df_long, formula = tempRowID ~ species, fun.aggregate = sum)
polbis.data=merge(polbis.data, sp_df, by="tempRowID") #now, re add reorganized data back to df
polbis.data=polbis.data[,-1] #remove tempRowID col
#View(polbis.data)
write.csv(polbis.data, "data/processed_PolBis.Data.Living.22.csv", row.names = F)
#Bring in polbis data from github folder
polbis.data <- read.csv("data/processed_PolBis.Data.Living.22.csv")
polbis.data <- as.data.frame(polbis.data)
#polbis.data <- subset(polbis.data[1:430,])
str(polbis.data)
#making continuous variables numeric (height, diameter, canopy cover, slope aspect)
polbis.data$X19.height <- as.numeric(as.character(polbis.data$X19.height))
polbis.data$X19.diameter <- as.numeric(as.character(polbis.data$X19.diameter))
polbis.data$X21.diameter  <- as.numeric(as.character(polbis.data$X21.diameter ))
polbis.data$X21.height  <- as.numeric(as.character(polbis.data$X21.height ))
polbis.data$canopy.cover <- as.numeric(as.character(polbis.data$canopy.cover))
polbis.data$angles <- as.numeric(as.character(polbis.data$slope.angle))
polbis.data$percent.native <- as.numeric(as.character(polbis.data$percent.native))
str(polbis.data)
#Histograms of numeric environmental  variables
hist(polbis.data$angles)
print(polbis.data$site)
#Creating new column for aggregation categories of similar genetic founders
polbis.data <- polbis.data %>%
mutate(genetic.group = case_when(
founder.georef %in% c("POLBIS-KA-HUL-C-0001", "POLBIS-KA-HUL-C-0003", "POLBIS-KA-HUL-E-0001", "POLBIS-KA-HUL-E-0003") ~ "haupu",
founder.georef %in% c("POLBIS-KA-HUL-B-0001", "POLBIS-KA-HUL-B-0004", "POLBIS-KA-HUL-B-0005", "POLBIS-KA-HUL-B-0006", "POLBIS-KA-HUL-B-0007", "POLBIS-KA-HUL-B-0008") ~ "kahili.lower",
founder.georef %in% c("POLBIS-KA-HUL-D-0001", "POLBIS-KA-HUL-D-0007", "POLBIS-KA-HUL-A-0003", "POLBIS-KA-HUL-A-0004", "POLBIS-KA-HUL-A-0005", "POLBIS-KA-HUL-A-0009") ~ "kahili.upper",
founder.georef %in% c("POLBIS-KA-KAP-A-0001", "POLBIS-KA-KAP-A-0003", "POLBIS-KA-KAP-A-0006") ~ "makaleha",
founder.georef %in% c("POLBIS-KA-XXX-X-XXXX") ~ "unknown.founder",
TRUE ~ "other"
))
#Creating new column for degree of weed control at each site
polbis.data <- polbis.data %>%
mutate(weed.control = case_when(
site %in% c("Laauhihaihai", "LowerHaupu", "Makaleha", "PuuKolo", "Nounou") ~ "none",
site %in% c("BlueHole", "HaupuSummit", "Kanaele", "McBryde") ~ "sporadic",
site %in% c("LowerLimahuli", "UpperLimahuli") ~ "consistent"))
print(polbis.data$site)
polbis.data$site <- factor(polbis.data$site, levels=c("PuuKolo", "McBryde", "LowerLimahuli",
"Nounou","HaupuSummmit","Makaleha","LowerHaupu",
"Laauhihaihai","BlueHole", "UpperLimahuli","Kanaele"))
print(polbis.data$site)
polbis.data$site <- factor(polbis.data$site, levels=c("PuuKolo", "McBryde", "LowerLimahuli",
"Nounou","HaupuSummit","Makaleha","LowerHaupu",
"Laauhihaihai","BlueHole", "UpperLimahuli","Kanaele"))
ggplot(polbis.data, aes(x =site, fill=X21.vigor)) + geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent) +  scale_fill_brewer(palette = "Pastel1") +
theme(axis.text.x = element_text(angle = 90))
print(polbis.data$site)
print(polbis.data$site)
#Bring in polbis data from github folder
polbis.data <- read.csv("data/processed_PolBis.Data.Living.22.csv")
polbis.data <- as.data.frame(polbis.data)
#polbis.data <- subset(polbis.data[1:430,])
str(polbis.data)
#making continuous variables numeric (height, diameter, canopy cover, slope aspect)
polbis.data$X19.height <- as.numeric(as.character(polbis.data$X19.height))
polbis.data$X19.diameter <- as.numeric(as.character(polbis.data$X19.diameter))
polbis.data$X21.diameter  <- as.numeric(as.character(polbis.data$X21.diameter ))
polbis.data$X21.height  <- as.numeric(as.character(polbis.data$X21.height ))
polbis.data$canopy.cover <- as.numeric(as.character(polbis.data$canopy.cover))
polbis.data$angles <- as.numeric(as.character(polbis.data$slope.angle))
polbis.data$percent.native <- as.numeric(as.character(polbis.data$percent.native))
str(polbis.data)
#Histograms of numeric environmental  variables
hist(polbis.data$angles)
#subset polbis data for only numeric variables
polbis.cont.variables <- subset(polbis.data, select=c('X21.height','X21.diameter','change.height','change.diam',
'slope.angle', 'canopy.cover', 'percent.native','understory.depth','uluhe',
'native.herbaceous','native.woody','naturalized.herbaceous','naturalized.poaceae',
'naturalized.woody'))
#Creating new column for aggregation categories of similar genetic founders
polbis.data <- polbis.data %>%
mutate(genetic.group = case_when(
founder.georef %in% c("POLBIS-KA-HUL-C-0001", "POLBIS-KA-HUL-C-0003", "POLBIS-KA-HUL-E-0001", "POLBIS-KA-HUL-E-0003") ~ "haupu",
founder.georef %in% c("POLBIS-KA-HUL-B-0001", "POLBIS-KA-HUL-B-0004", "POLBIS-KA-HUL-B-0005", "POLBIS-KA-HUL-B-0006", "POLBIS-KA-HUL-B-0007", "POLBIS-KA-HUL-B-0008") ~ "kahili.lower",
founder.georef %in% c("POLBIS-KA-HUL-D-0001", "POLBIS-KA-HUL-D-0007", "POLBIS-KA-HUL-A-0003", "POLBIS-KA-HUL-A-0004", "POLBIS-KA-HUL-A-0005", "POLBIS-KA-HUL-A-0009") ~ "kahili.upper",
founder.georef %in% c("POLBIS-KA-KAP-A-0001", "POLBIS-KA-KAP-A-0003", "POLBIS-KA-KAP-A-0006") ~ "makaleha",
founder.georef %in% c("POLBIS-KA-XXX-X-XXXX") ~ "unknown.founder",
TRUE ~ "other"
))
#Creating new column for degree of weed control at each site
polbis.data <- polbis.data %>%
mutate(weed.control = case_when(
site %in% c("Laauhihaihai", "LowerHaupu", "Makaleha", "PuuKolo", "Nounou") ~ "none",
site %in% c("BlueHole", "HaupuSummit", "Kanaele", "McBryde") ~ "sporadic",
site %in% c("LowerLimahuli", "UpperLimahuli") ~ "consistent"))
print(polbis.data$site)
polbis.data$site <- factor(polbis.data$site, levels=c("PuuKolo", "McBryde", "LowerLimahuli",
"Nounou","HaupuSummit","Makaleha","LowerHaupu",
"Laauhihaihai","BlueHole", "UpperLimahuli","Kanaele"))
print(polbis.data$site)
ggplot(polbis.data, aes(x =site, fill=X21.vigor)) + geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent) +  scale_fill_brewer(palette = "Pastel1") +
theme(axis.text.x = element_text(angle = 90))
ggplot(polbis.data, aes(x =site, fill=X21.vigor)) + geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent) +  scale_fill_brewer(palette = "Pastel1") +
theme(axis.text.x = element_text(angle = 90)) + labs(title = "Vigor across Sites",
x = "Reintroduction Site",
y = "Proportion of plants",
fill = "Vigor (2021)")
ggplot(polbis.data, aes(x =site, fill=X21.vigor)) + geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent) +  scale_fill_brewer(palette = "Pastel1") +
theme(axis.text.x = element_text(angle = 90)) + labs(title = "Polbis vigor across sites",
x = "Reintroduction Site",
y = "Proportion of plants",
fill = "Vigor (2021)")
ggplot(polbis.data, aes(x =site, fill=X21.vigor)) + geom_bar(color = "black", position = "fill") +
scale_y_continuous(labels = scales::percent) +  scale_fill_brewer(palette = "Pastel1") +
theme(axis.text.x = element_text(angle = 90)) + labs(title = "Polbis vigor across sites",
x = "Reintroduction Site",
y = "Proportion of plants",
fill = "Vigor (2021)")
ggplot(polbis.data, aes(x =site, fill=X21.vigor)) + geom_bar(color = "black", position = "fill") +
scale_y_continuous(labels = scales::percent) +  scale_fill_brewer(palette = "Pastel1") +
theme(axis.text.x = element_text(angle = 90)) + labs(title = "Polbis vigor across sites",
x = "Reintroduction Site",
y = "Proportion of population",
fill = "Vigor (2021)")
dredge(saturated.model)
dredge1 <- dredge(saturated.model)
saturated.model <- glm(log.height~genetic.group+canopy.cover+understory.height+
slope.angle+weed.control+native.herbaceous+native.woody+uluhe+
naturalized.herbaceous+naturalized.woody+naturalized.poaceae+(1|site),
data=subset.polbis.data, na.action = "na.fail")
saturated.model <- glm(log.height~genetic.group+canopy.cover+understory.height+
slope.angle+weed.control+native.herbaceous+native.woody+uluhe+
naturalized.herbaceous+naturalized.woody+naturalized.poaceae+(site|1),
data=subset.polbis.data, na.action = "na.fail")
View(dredge1)
