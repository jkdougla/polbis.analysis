group_by(site) %>%
summarize_at(.vars="X21.height", funs=~ mean_sd(., na_rm = TRUE))%>%
gt() %>%
tab_header(
title = md("*Polyscias bisattenutata* Survival and Growth 2021")
subtitle = md("Across 11 reintroduction sites on eastern Kaua'i "))
#Working on making summary table of growth and survival across sites
growth.survival.table <- polbis.data %>%
group_by(site) %>%
summarize_at(.vars="X21.height", funs=~ mean_sd(., na_rm = TRUE))%>%
gt() %>%
tab_header(
title = md("*Polyscias bisattenutata* Survival and Growth 2021"),
subtitle = md("Across 11 reintroduction sites on eastern Kaua'i "))
#Working on making summary table of growth and survival across sites
growth.survival.table <- polbis.data %>%
group_by(site) %>%
summarize_at(.vars="X21.height", .funs=~ mean_sd(., na_rm = TRUE))%>%
gt() %>%
tab_header(
title = md("*Polyscias bisattenutata* Survival and Growth 2021"),
subtitle = md("Across 11 reintroduction sites on eastern Kaua'i "))
#Working on making summary table of growth and survival across sites
growth.survival.table <- polbis.data %>%
group_by(site) %>%
summarize_at(
.vars=c("X21.height", "X21.diam"),
.funs=~ mean_sd(., na_rm = TRUE))%>%
gt() %>%
tab_header(
title = md("*Polyscias bisattenutata* Survival and Growth 2021"),
subtitle = md("Across 11 reintroduction sites on eastern Kaua'i "))
#Working on making summary table of growth and survival across sites
growth.survival.table <- polbis.data %>%
group_by(site) %>%
summarize_at(
.vars=c("X21.height", "X21.diameter"),
.funs=~ mean_sd(., na_rm = TRUE))%>%
gt() %>%
tab_header(
title = md("*Polyscias bisattenutata* Survival and Growth 2021"),
subtitle = md("Across 11 reintroduction sites on eastern Kaua'i "))
#Working on making summary table of growth and survival across sites
growth.survival.table <- polbis.data %>%
group_by(site) %>%
summarize_at(
.vars=c("X21.height", "X21.diameter"),
.funs=~ mean(., na_rm = TRUE))%>%
gt(rowname_col = "site") %>%
tab_header(
title = md("*Polyscias bisattenutata* Survival and Growth 2021"),
subtitle = md("Across 11 reintroduction sites on eastern Kaua'i "))
print(growth.survival.table)
#Working on making summary table of growth and survival across sites
growth.survival.table <- polbis.data %>%
group_by(site) %>%
summarize_at(
.vars=c("X21.height", "X21.diameter"),
.funs=~ mean_sd(., na_rm = TRUE))%>%
gt(rowname_col = "site") %>%
tab_header(
title = md("*Polyscias bisattenutata* Survival and Growth 2021"),
subtitle = md("Across 11 reintroduction sites on eastern Kaua'i "))
print(growth.survival.table)
#Working on making summary table of growth and survival across sites
growth.survival.table <- polbis.data %>%
group_by(site) %>%
summarize_at(
.vars=c("X21.height", "X21.diameter","change.height","change.diam"),
.funs=~ mean_sd(., na_rm = TRUE))%>%
gt(rowname_col = "site") %>%
tab_header(
title = md("*Polyscias bisattenutata* Survival and Growth 2021"),
subtitle = md("Across 11 reintroduction sites on eastern Kaua'i "))
print(growth.survival.table)
#Working on making summary table of growth and survival across sites
growth.survival.table <- polbis.data %>%
group_by(site) %>%
summarize_at(
.vars=c("X21.height", "X21.diameter","change.height","change.diam"),
.funs=~ mean(., na_rm = TRUE))%>%
gt(rowname_col = "site") %>%
tab_header(
title = md("*Polyscias bisattenutata* Survival and Growth 2021"),
subtitle = md("Across 11 reintroduction sites on eastern Kaua'i "))
print(growth.survival.table)
#Working on making summary table of growth and survival across sites
growth.survival.table <- polbis.data %>%
group_by(site) %>%
summarize_at(
.vars=c("X21.height", "X21.diameter","change.height","change.diam"),
.funs=~ mean(., na_rm = TRUE))%>%
gt(rowname_col = "site") %>%
tab_header(
title = md("*Polyscias bisattenutata* Survival and Growth 2021"),
subtitle = md("Across 11 reintroduction sites on eastern Kaua'i "))
print(growth.survival.table)
#Working on making summary table of growth and survival across sites
growth.survival.table <- polbis.data %>%
group_by(site) %>%
summarize_at(
.vars=c("X21.height", "X21.diameter","change.height","change.diam"),
.funs=~ mean(., na_rm = TRUE))%>%
gt(rowname_col = "site") %>%
tab_header(
title = md("*Polyscias bisattenutata* Survival and Growth 2021"),
subtitle = md("Across 11 reintroduction sites on eastern Kaua'i ")
)%>%
cols_label(X21.height=md("Mean (SD) Height (cm)"))
print(growth.survival.table)
fmt_number(columns=everything())
subtitle = md("Across 11 reintroduction sites on eastern Kaua'i "))%>%
subtitle = md("Across 11 reintroduction sites on eastern Kaua'i ")%>%
fmt_number(columns=everything())
print(growth.survival.table)
#Working on making summary table of growth and survival across sites
growth.survival.table <- polbis.data %>%
group_by(site) %>%
summarize_at(
.vars=c("X21.height", "X21.diameter","change.height","change.diam"),
.funs=~ mean(., na_rm = TRUE))%>%
gt(rowname_col = "site") %>%
tab_header(
title = md("*Polyscias bisattenutata* Survival and Growth 2021"),
subtitle = md("Across 11 reintroduction sites on eastern Kaua'i "))%>%
cols_label(X21.height=md("Height (cm)")) %>%
fmt_number(columns=everything())
print(growth.survival.table)
library('gtsummary')
polbis.data %>% select(c("X21.height", "X21.diameter","change.height","change.diam")) tbl_summary()
polbis.data %>% select(c(X21.height, X21.diameter,change.height,change.diam))%>% tbl_summary()
polbis.data %>% select(c(X21.height, X21.diameter,change.height,change.diam))%>% tbl_summary(by=site)
polbis.data %>% select(c(X21.height, X21.diameter,change.height,change.diam))%>% tbl_summary(by=site)
polbis.data %>% select(c("X21.height", "X21.diameter","change.height","change.diam"))%>% tbl_summary(by=site)
polbis.data %>% select(c("X21.height", "X21.diameter","change.height","change.diam")) %>%
tbl_summary(
by= site )
polbis.data %>% select(!c("X21.height", "X21.diameter","change.height","change.diam")) %>%
tbl_summary(
by= site )
summary_table <- polbis.data %>%
select(site, X21.height, X21.diameter,change.height,change.diam) %>%
group_by(site) %>%
statistic = list(all_continuous() ~ "{mean} ({sd})", )
summary_table <- polbis.data %>%
select(site, X21.height, X21.diameter,change.height,change.diam) %>%
group_by(site) %>%
statistic = list(all_continuous() ~ "{mean} ({sd})")
#mean and standard deviation of '21 height and diameter
mean(polbis.data$X21.height, na.rm = TRUE)
sd(polbis.data$X21.height, na.rm = TRUE)
tapply(polbis.data$X21.height, list(polbis.data$site, polbis.data$kpep.georef),mean, na.rm=TRUE)
tapply(polbis.data$X21.height, polbis.data$site, mean, na.rm=TRUE)
tapply(polbis.data$X21.height, polbis.data$site, count, na.rm=TRUE)
tapply(polbis.data$X21.height, polbis.data$site, na.rm=TRUE)
str(polbis.data)
summary(polbis.data$change.diam)
as.table(polbis.data$site)
tapply(polbis.data$site)
tapply(polbis.data$site,polbis.data$X21.height, mean, na.rm=TRUE)
tapply(polbis.data$X21.height, polbis.data$site, mean, na.rm=TRUE)
tapply(polbis.data$X21.height, list(polbis.data$site, polbis.data$kpep.georef),mean, na.rm=TRUE)
tapply(polbis.data$X21.diameter, polbis.data$site, mean, na.rm=TRUE)
tapply(polbis.data$change.height, polbis.data$site, mean, na.rm=TRUE)
tapply(polbis.data$change.diam, polbis.data$site, mean, na.rm=TRUE)
str(polbis.data$site)
tapply(polbis.data$site)
as.table(polbis.data$site)
print(polbis.data$site)
#Numbers of living polbis across sites in 2021
table(polbis.data$site)
tapply(polbis.data$X21.height, polbis.data$site, sd, na.rm=TRUE)
tapply(polbis.data$X21.height, polbis.data$site, mean_sd, na.rm=TRUE)
tapply(polbis.data$X21.height, polbis.data$site, sd, na.rm=TRUE)
tapply(polbis.data$X21.height, polbis.data$site, sd, na.rm=TRUE)
tapply(polbis.data$X21.diameter, polbis.data$site, sd, na.rm=TRUE)
means_table <- sapply(polbis.data[, c("X21.height", "X21.diameter")], function(x) tapply(x, data$site, mean))
sapply(polbis.data[, c("X21.height", "X21.diameter")], function(x) tapply(x, data$site, mean))
tapply(polbis.data$X21.diameter, polbis.data$site, mean, na.rm=TRUE))
data.frame(cbind(
tapply(polbis.data$X21.height, polbis.data$site, mean, na.rm=TRUE),
tapply(polbis.data$X21.diameter, polbis.data$site, mean, na.rm=TRUE)))
data.frame(cbind(
tapply(polbis.data$X21.height, polbis.data$site, mean, na.rm=TRUE),
tapply(polbis.data$X21.height, polbis.data$site, sd, na.rm=TRUE),
tapply(polbis.data$X21.diameter, polbis.data$site, mean, na.rm=TRUE)))
data.frame(cbind(
tapply(polbis.data$X21.height, polbis.data$site, mean, na.rm=TRUE),
tapply(polbis.data$X21.height, polbis.data$site, sd, na.rm=TRUE),
tapply(polbis.data$X21.diameter, polbis.data$site, mean, na.rm=TRUE),
tapply(polbis.data$X21.diameter, polbis.data$site, sd, na.rm=TRUE),
tapply(polbis.data$change.height, polbis.data$site, mean, na.rm=TRUE),
tapply(polbis.data$change.height, polbis.data$site, sd, na.rm=TRUE),
tapply(polbis.data$change.diam, polbis.data$site, mean, na.rm=TRUE),
tapply(polbis.data$change.diam, polbis.data$site, sd, na.rm=TRUE)))
data.frame(cbind(
tapply(polbis.data$site, count),
tapply(polbis.data$X21.height, polbis.data$site, mean, na.rm=TRUE),
tapply(polbis.data$X21.height, polbis.data$site, sd, na.rm=TRUE),
tapply(polbis.data$X21.diameter, polbis.data$site, mean, na.rm=TRUE),
tapply(polbis.data$X21.diameter, polbis.data$site, sd, na.rm=TRUE),
tapply(polbis.data$change.height, polbis.data$site, mean, na.rm=TRUE),
tapply(polbis.data$change.height, polbis.data$site, sd, na.rm=TRUE),
tapply(polbis.data$change.diam, polbis.data$site, mean, na.rm=TRUE),
tapply(polbis.data$change.diam, polbis.data$site, sd, na.rm=TRUE)))
#Summary table of size and growth measurements across founders (mean and standard deviation)
data.frame(cbind(
tapply(polbis.data$X21.height, polbis.data$founder.georef, mean, na.rm=TRUE),
tapply(polbis.data$X21.height, polbis.data$founder.georef, sd, na.rm=TRUE),
tapply(polbis.data$X21.diameter, polbis.data$founder.georef, mean, na.rm=TRUE),
tapply(polbis.data$X21.diameter, polbis.data$founder.georef, sd, na.rm=TRUE),
tapply(polbis.data$change.height, polbis.data$founder.georef, mean, na.rm=TRUE),
tapply(polbis.data$change.height, polbis.data$founder.georef, sd, na.rm=TRUE),
tapply(polbis.data$change.diam, polbis.data$founder.georef, mean, na.rm=TRUE),
tapply(polbis.data$change.diam, polbis.data$founder.georef, sd, na.rm=TRUE)))
#Summary table of size and growth measurements across founders (mean and standard deviation)
data.frame(cbind(
tapply(polbis.data$X21.height, polbis.data$founder.georef, mean, na.rm=TRUE),
tapply(polbis.data$X21.height, polbis.data$founder.georef, sd, na.rm=TRUE),
tapply(polbis.data$X21.diameter, polbis.data$founder.georef, mean, na.rm=TRUE),
tapply(polbis.data$X21.diameter, polbis.data$founder.georef, sd, na.rm=TRUE),
tapply(polbis.data$change.height, polbis.data$founder.georef, mean, na.rm=TRUE),
tapply(polbis.data$change.height, polbis.data$founder.georef, sd, na.rm=TRUE),
tapply(polbis.data$change.diam, polbis.data$founder.georef, mean, na.rm=TRUE),
tapply(polbis.data$change.diam, polbis.data$founder.georef, sd, na.rm=TRUE)))
#Summary table of size and growth measurements across founders (mean and standard deviation)
founder.summarytable <- data.frame(cbind(
tapply(polbis.data$X21.height, polbis.data$founder.georef, mean, na.rm=TRUE),
tapply(polbis.data$X21.height, polbis.data$founder.georef, sd, na.rm=TRUE),
tapply(polbis.data$X21.diameter, polbis.data$founder.georef, mean, na.rm=TRUE),
tapply(polbis.data$X21.diameter, polbis.data$founder.georef, sd, na.rm=TRUE),
tapply(polbis.data$change.height, polbis.data$founder.georef, mean, na.rm=TRUE),
tapply(polbis.data$change.height, polbis.data$founder.georef, sd, na.rm=TRUE),
tapply(polbis.data$change.diam, polbis.data$founder.georef, mean, na.rm=TRUE),
tapply(polbis.data$change.diam, polbis.data$founder.georef, sd, na.rm=TRUE)))
write.csv(founder.summarytable, "~/Desktop")
write.csv(founder.summarytable)
table(polbis.data$founder.georef)
#Summary table of size and growth measurements across sites (mean and standard deviation)
mean(polbis.dataX21.height)
#Summary table of size and growth measurements across sites (mean and standard deviation)
mean(polbis.data$X21.height, na.rm=TRUE)
#Summary table of size and growth measurements across sites (mean and standard deviation)
sd(polbis.data$X21.height, na.rm=TRUE)
#Summary table of size and growth measurements across sites (mean and standard deviation)
sd(polbis.data$X21.diameter, na.rm=TRUE)
#Summary table of size and growth measurements across sites (mean and standard deviation)
mean(polbis.data$X21.diameter, na.rm=TRUE)
#Summary table of size and growth measurements across sites (mean and standard deviation)
sd(polbis.data$X21.diameter, na.rm=TRUE)
#Summary table of size and growth measurements across sites (mean and standard deviation)
sd(polbis.data$change.height, na.rm=TRUE)
#Summary table of size and growth measurements across sites (mean and standard deviation)
mean(polbis.data$change.height, na.rm=TRUE)
#Summary table of size and growth measurements across sites (mean and standard deviation)
mean(polbis.data$change.diam, na.rm=TRUE)
#Summary table of size and growth measurements across sites (mean and standard deviation)
sd(polbis.data$change.diam, na.rm=TRUE)
library(ggplot2)
library(ggcorrplot)
library(qwraps2)
library('gtsummary')
library('dplyr')
library('vegan')
library('gt')
library('tidyverse')
#important! add your repo path here so r knows where are the repo files!
repo_path1="D:/projects/2021_ntbg/polbis_analysis/"
repo_path2="~/Desktop/ohe.mauka/Polyscias Kauai 2022/polbis.analysis/" #JULIA, place your repo directory here
REPO_dirs=c(repo_path1, repo_path2)
repo_dir=REPO_dirs[min(which(dir.exists(REPO_dirs)))]
setwd(repo_dir)
#Bring in polbis data from github folder
polbis.data <- read.csv("data/processed_PolBis.Data.Living.22.csv")
polbis.data <- as.data.frame(polbis.data)
#making continuous variables numeric (height, diameter, canopy cover, slope aspect)
polbis.data$X19.height <- as.numeric(as.character(polbis.data$X19.height))
polbis.data$X19.diameter <- as.numeric(as.character(polbis.data$X19.diameter))
polbis.data$X21.diameter  <- as.numeric(as.character(polbis.data$X21.diameter ))
polbis.data$X21.height  <- as.numeric(as.character(polbis.data$X21.height ))
polbis.data$canopy.cover <- as.numeric(as.character(polbis.data$canopy.cover))
polbis.data$angles <- as.numeric(as.character(polbis.data$angles))
polbis.data$percent.native <- as.numeric(as.character(polbis.data$percent.native))
str(polbis.data)
knitr::opts_chunk$set(echo = TRUE)
hist(polbis.data$angles)
hist(polbis.data$slope.angle)
par(mfrow=c(2,2))
hist(polbis.data$slope.angle)
hist(polbis.data$understory.depth)
hist(polbis.data$percent.native)
hist(polbis.data$canopy.cover)
hist1 <- hist(polbis.data$slope.angle)
hist2 <- hist(polbis.data$understory.depth)
grid.arange(hist1, hist2)
install.packages('grid.arrange')
install.packages(gridExtra)
#2021 boxplot heights and diameter across sites
ggplot(data=polbis.data, aes(x=site, y=X21.height)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90))
#2021 boxplot heights and diameter across sites
ggplot(data=polbis.data, aes(x=site, y=X21.height)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90)) +facet_wrap(.~X21.diameter)
#2021 boxplot heights and diameter across sites
ggplot(data=polbis.data, aes(x=site, y=X21.height)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90))
ggplot(data=polbis.data, aes(x=site, y=X21.diameter)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90))
#Change (growth) in height and diameter across sites
ggplot(data=polbis.data, aes(x=site, y=change.height)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90))
ggplot(data=polbis.data, aes(x=site, y=change.diam)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90))
#Change (growth) in height and diameter across sites
boxplot1 <- ggplot(data=polbis.data, aes(x=site, y=change.height)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90))
boxplot2 <- ggplot(data=polbis.data, aes(x=site, y=change.diam)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90))
figure <- ggarrange(boxplot1, boxplot2, ncol = 2, nrow = 2)
install.packages (ggpubr)
install.packages("ggpubr")
install.packages("ggpubr")
library(ggplot2)
library(ggcorrplot)
library(qwraps2)
library('gtsummary')
library('dplyr')
library('vegan')
library('gt')
library('tidyverse')
library('ggpubr)
library(ggplot2)
library(ggcorrplot)
library(qwraps2)
library('gtsummary')
library('dplyr')
library('vegan')
library('gt')
library('tidyverse')
library('ggpubr)'
library(ggplot2)
library(ggcorrplot)
library(qwraps2)
library('gtsummary')
library('dplyr')
library('vegan')
library('gt')
library('tidyverse')
library('ggpubr')
figure <- ggarrange(boxplot1, boxplot2, ncol = 2, nrow = 2)
figure
figure <- ggarrange(boxplot1, boxplot2)
figure <- ggarrange(boxplot1, boxplot2)
figure <- ggarrange(boxplot1, boxplot2, nrow=1,ncol=2)
#Change (growth) in height and diameter across sites
boxplot1 <- ggplot(data=polbis.data, aes(x=site, y=change.height)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90))
bosplot1
boxplot1
ggarrange(boxplot1, boxplot2, nrow=1,ncol=2)
ggarrange(boxplot1, boxplot2, nrow=1,ncol=2, heights=c(2,1),widths=c(0.5,1))
ggarrange(boxplot1, boxplot2, nrow=1,ncol=2, heights=c(2,1),widths=c(0.5,1))
ggarrange(boxplot1, boxplot2, nrow=1,ncol=2, heights=c(2,2),widths=c(0.5,1))
ggarrange(boxplot1, boxplot2, nrow=1,ncol=2, heights=c(2,2),widths=c(1,1))
ggarrange(boxplot1, boxplot2, nrow=1,ncol=2, heights=c(2,2),widths=c(1.5,1.5))
ggarrange(boxplot1, boxplot2, nrow=1,ncol=2, heights=c(1,2),widths=c(1.5,1.5))
ggarrange(boxplot1, boxplot2, nrow=1,ncol=2, heights=c(.5,2),widths=c(1.5,1.5))
ggarrange(boxplot1, boxplot2, nrow=1,ncol=2,widths=c(2,2))
ggarrange(boxplot1, boxplot2, nrow=1,ncol=2,widths=c(4,2))
ggarrange(boxplot1, boxplot2, nrow=1,ncol=2,widths=c(2,2))
ggarrange(boxplot.3, boxplot3, nrow=1,ncol=2,widths=c(,2))
#2021 boxplot heights and diameter across sites
boxplot.3 <- ggplot(data=polbis.data, aes(x=site, y=X21.height)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90))
boxplot.4 <- ggplot(data=polbis.data, aes(x=site, y=X21.diameter)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90))
ggarrange(boxplot.3, boxplot3, nrow=1,ncol=2,widths=c(,2))
ggarrange(boxplot.3, boxplot.4, nrow=1,ncol=2,widths=c(,2))
ggarrange(boxplot.3, boxplot.4, nrow=1,ncol=2)
ggplot(data=polbis.data, aes(x=site)) + geom_bar() + theme(axis.text.x = element_text(angle = 90))
ggplot(data=polbis.data, aes(x=founder.georef)) + geom_bar() + theme(axis.text.x = element_text(angle = 90))
#Plot of founders represented in living reintroductions across sites
ggplot(data=polbis.data, aes(x=site, fill=founder.georef)) + geom_bar() + theme(axis.text.x = element_text(angle = 90))
#subset polbis data for only numeric variables
polbis.cont.variables <- subset(polbis.data, select=c('X19.height','X19.diameter','X21.height','X21.diameter', 'aspect', 'canopy.cover', 'percent.native'))
str(polbis.cont.variables)
#correlation matrix of continuous variables
rquery.cormat(polbis.cont.variables
#correlation matrix of continuous variables
rquery.cormat(polbis.cont.variables
#correlation matrix of continuous variables
rquery.cormat(polbis.cont.variables)
source("http://www.sthda.com/upload/rquery_cormat.r")
rquery.cormat(polbis.data)
#correlation matrix of continuous variables
rquery.cormat(polbis.cont.variables)
#correlation matrix of continuous variables
rquery.cormat(polbis.cont.variables)
#making continuous variables numeric (height, diameter, canopy cover, slope aspect)
polbis.data$X19.height <- as.numeric(as.character(polbis.data$X19.height))
polbis.data$X19.diameter <- as.numeric(as.character(polbis.data$X19.diameter))
polbis.data$X21.diameter  <- as.numeric(as.character(polbis.data$X21.diameter ))
polbis.data$angles <- as.numeric(as.character(polbis.data$slope.angle))
polbis.data$percent.native <- as.numeric(as.character(polbis.data$percent.native))
str(polbis.data)
#correlation matrix of continuous variables
rquery.cormat(polbis.cont.variables)
#subset polbis data for only numeric variables
polbis.cont.variables <- subset(polbis.data, select=c('X19.height','X19.diameter','X21.height','X21.diameter', 'slope.angle', 'canopy.cover', 'percent.native'))
str(polbis.cont.variables)
polbis.data$angles <- as.numeric(as.character(polbis.data$slope.angle))
#subset polbis data for only numeric variables
polbis.cont.variables <- subset(polbis.data, select=c('X19.height','X19.diameter','X21.height','X21.diameter', 'slope.angle', 'canopy.cover', 'percent.native'))
str(polbis.cont.variables)
#correlation matrix of continuous variables
rquery.cormat(polbis.cont.variables)
#correlation matrix of continuous variables
rquery.cormat(polbis.cont.variables)
corrplot(polbis.cont.variables)
corrplot(rquery.cormat(polbis.cont.variables))
polbis.environmental.variables <- subset(polbis.data, select=c(site,canopy.cover, percent.native, slope.angle,understory.depth,
naturalized.herbaceous, native.woody, naturalized.woody, naturalized.poaceae, uluhe)) #subsetting for the env.measured
polbis.environmental.variables["percent.native"][is.na(polbis.environmental.variables["percent.native"])] <- 0 #removing NAs from data, replacing 0 for NA for percent.native, because some sites have no canopy
polbis.environmental.variables <- na.omit(polbis.environmental.variables) #removing another few odd NAs in there
polbis.environmental.variables <- subset(polbis.data, select=c(site,canopy.cover, percent.native, slope.angle,understory.depth,
naturalized.herbaceous, native.woody, naturalized.woody, naturalized.poaceae, uluhe)) #subsetting for the env.measured
#Creating new summary columns of vegetation plot categories. Species can be moved as needed, or extracted if independently important (i.e. uluhe, invasive grass, etc)
polbis.data <- polbis.data %>%
mutate(native.herbaceous = (Alyxia.stellata+Bidens.spp+Bidens.spp+Cyanea.fissa+Cyanea.spp+Dianella.sandwicensis+
Diplazium.sandwichianum+Diplazium.sandwichianum+Doryopteris.sp+Dryopteris.spp+
Dubautia.spp+Dubautia.spp+Elaphoglossum.spp+Gahnia.beecheyi+Machaerina.angustifolia+Machaerina.mariscoides+
Microlepia.strigosa.+nativeherb+Odontosoria.chinensis+Palhinhaea.cernua+Peperomia.spp+Sadleria.cyatheoides+
Rubus.argutus+Sadleria.spp+Tectaria.gaudichaudii+Viola.wailenalenae),
native.woody = (Antidesma.platyphyllum+Cibotium.glaucum+Cyrtandra.spp+Diospyros.sandwicensis+Freycinetia.arborea+
Hydrangea.arguta+Ilex.anomala+Kadua.spp+Leptecophylla.tameiameiae+Metrosideros.polymorpha+
Myrsine.lessertiana+nativewood+Perrottetia.sandwicensis+Pipturus.albidus+Pipturus.ruber+Psychotria.spp+Psychotria.mariniana+Polyscias.oahuensis+
Vaccinium.calycinum+Syzygium.sandwicense+Scaevola.gaudichaudiana+Scaevola.procera),
uluhe = (Dicranopteris.linearis),
naturalized.herbaceous = (Ageratum.conyzoides+Blechnum.appendiculatum+Christella.dentata+Cyperus.spp+Elephantopus.mollis+invherb+
Ipomea.spp+Nephrolepis.spp+Paederia.foetida+Passiflora.spp+Phaius.tankervilleae+
Phlebotium.aureum+Pluchea.spp+Selaginella.spp+Stachytarpheta.cayennensis),
naturalized.woody = (Clidemia.hirta+Cordyline.fruticosa+invwood+Leucaena.leucocephala+Melastoma.septemnervium+
Psidium.cattleyanum+Schinus.terebinthifolius),
naturalized.poaceae = (Andropogon.spp+Megathyrsus.maximus+Melinis.minutiflora+Oplismenus.hirtellus+Invasive.Grass))
#PCA of environmental variables
polbis.environmental.variables <- subset(polbis.data, select=c(site,canopy.cover, percent.native, slope.angle,understory.depth,
naturalized.herbaceous, native.woody, naturalized.woody, naturalized.poaceae, uluhe)) #subsetting for the env.measured
polbis.environmental.variables["percent.native"][is.na(polbis.environmental.variables["percent.native"])] <- 0 #removing NAs from data, replacing 0 for NA for percent.native, because some sites have no canopy
polbis.environmental.variables <- na.omit(polbis.environmental.variables) #removing another few odd NAs in there
str(polbis.environmental.variables)
pca.polbis.dataset <- subset(polbis.environmental.variables, select=c(canopy.cover, percent.native, slope.angle,understory.depth,
naturalized.herbaceous, native.woody, naturalized.woody, naturalized.poaceae, uluhe))#removing site as a categorical variable
pca.polbis.dataset.scaled <- as.data.frame(scale(pca.polbis.dataset))#scaling it
rda.polbis.sites <- rda(pca.polbis.dataset.scaled)
biplot(rda.polbis.sites)
points(rda.polbis.sites, disp="sites", pch=20, col="green", select=polbis.environmental.variables$site=="Nounou", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="2", select=polbis.environmental.variables$site=="LowerLimahuli", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="4", select=polbis.environmental.variables$site=="Makaleha", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="5", select=polbis.environmental.variables$site=="McBryde", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="6", select=polbis.environmental.variables$site=="UpperLimahuli", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="dark green", select=polbis.environmental.variables$site=="HaupuSummit", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="8", select=polbis.environmental.variables$site=="Kanaele", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col= "gold", select=polbis.environmental.variables$site=="Laauhihaihai", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="10", select=polbis.environmental.variables$site=="PuuKolo", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="11", select=polbis.environmental.variables$site=="LowerHaupu", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="12", select=polbis.environmental.variables$site=="BlueHole", cex=1.3)
text(rda.polbis.sites, display="species", col="black", cex=1, pos=3, offset=.5)
legend("topright", col = c("green",2,4,5,6,"dark green",8,"gold",10,11,12), pch = 16,
legend = c("Nounou", "LowerLimahuli","Makaleha","McBryde","UpperLimahuli","HaupuSummit","Kanaele",
"Laauhihaihai","PuuKolo","LowerHaupu","BlueHole"))
polbis.environmental.variables <- subset(polbis.data, select=c(site,canopy.cover, percent.native, slope.angle,understory.depth,
naturalized.herbaceous, native.woody, naturalized.woody, naturalized.poaceae, uluhe)) #subsetting for the env.measured
polbis.environmental.variables["percent.native"][is.na(polbis.environmental.variables["percent.native"])] <- 0 #removing NAs from data, replacing 0 for NA for percent.native, because some sites have no canopy
polbis.environmental.variables <- na.omit(polbis.environmental.variables) #removing another few odd NAs in there
str(polbis.environmental.variables)
rda.polbis.sites <- rda(pca.polbis.dataset.scaled)
biplot(rda.polbis.sites)
points(rda.polbis.sites, disp="sites", pch=20, col="green", select=polbis.environmental.variables$site=="Nounou", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="2", select=polbis.environmental.variables$site=="LowerLimahuli", cex=1.3)
biplot(rda.polbis.sites)
points(rda.polbis.sites, disp="sites", pch=20, col="green", select=polbis.environmental.variables$site=="Nounou", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="2", select=polbis.environmental.variables$site=="LowerLimahuli", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="4", select=polbis.environmental.variables$site=="Makaleha", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="6", select=polbis.environmental.variables$site=="UpperLimahuli", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="8", select=polbis.environmental.variables$site=="Kanaele", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col= "gold", select=polbis.environmental.variables$site=="Laauhihaihai", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="11", select=polbis.environmental.variables$site=="LowerHaupu", cex=1.3)
points(rda.polbis.sites, disp="sites", pch=20, col="12", select=polbis.environmental.variables$site=="BlueHole", cex=1.3)
text(rda.polbis.sites, display="species", col="black", cex=1, pos=3, offset=.5)
biplot(rda.polbis.sites)
text(rda.polbis.sites, display="species", col="black", cex=1, pos=3, offset=.5)
quartz()
biplot(rda.polbis.sites)
points(rda.polbis.sites, disp="sites", pch=20, col="green", select=polbis.environmental.variables$site=="Nounou", cex=1.3)
rda.polbis.sites <- rda(pca.polbis.dataset.scaled)
biplot(rda.polbis.sites)
legend("topright", col = c("green",2,4,5,6,"dark green",8,"gold",10,11,12), pch = 16,
legend = c("Nounou", "LowerLimahuli","Makaleha","McBryde","UpperLimahuli","HaupuSummit","Kanaele",
"Laauhihaihai","PuuKolo","LowerHaupu","BlueHole"))
library(ggplot2)
library(ggcorrplot)
library(qwraps2)
library('gtsummary')
library('dplyr')
library('vegan')
library('gt')
library('tidyverse')
library('ggpubr')
library(ggplot2)
library(ggcorrplot)
library(qwraps2)
library('gtsummary')
library('dplyr')
library('vegan')
library('gt')
library('tidyverse')
library('ggpubr')
#2021 boxplot heights and diameter across sites
boxplot.3 <- ggplot(data=polbis.data, aes(x=site, y=X21.height)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90))
polbis.data <- read.csv("data/processed_PolBis.Data.Living.22.csv")
ggarrange(boxplot1, boxplot2, nrow=1,ncol=2,widths=c(,2))
quartz()
ggarrange(boxplot1, boxplot2, nrow=1,ncol=2,widths=c(,2))
